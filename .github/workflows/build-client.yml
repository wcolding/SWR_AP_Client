name: Build-Client

on: [push, pull_request]

jobs:
    build:
        name: Build Win

        runs-on: windows-latest

        steps:
        - uses: actions/checkout@v1
          with:
            submodules: 'recursive'
        - name: Build APCpp
          run: |
            mkdir SWR_AP_Client\external\APCpp\build
            cd SWR_AP_Client\external\APCpp\build
            cmake -G "Visual Studio 17 2022" -A Win32 `
              -DUSE_ZLIB=OFF `
              -DCMAKE_BUILD_TYPE=Release ..
            cmake --build . --config Release
        - name: Move APCpp
          run: |
            cd ..
            mkdir SWR_AP_Client\SWR_AP_Client\external\APCpp\out\build\x86-Release
            copy SWR_AP_Client\SWR_AP_Client\external\APCpp\build\Release\APCpp.dll SWR_AP_Client\SWR_AP_Client\external\APCpp\out\build\x86-Release
            copy SWR_AP_Client\SWR_AP_Client\external\APCpp\build\Release\APCpp.lib SWR_AP_Client\SWR_AP_Client\external\APCpp\out\build\x86-Release
        - name: Artifact
          uses: actions/upload-artifact@v3
          with:
            name: APCpp-win
            path: |
              SWR_AP_Client\SWR_AP_Client\SWR_AP_Client\external\APCpp\out\build\x86-Release\*
       
